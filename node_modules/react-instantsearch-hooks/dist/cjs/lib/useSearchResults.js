"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useSearchResults = useSearchResults;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _react = require("react");

var _getIndexSearchResults = require("./getIndexSearchResults");

var _useIndexContext = require("./useIndexContext");

var _useInstantSearchContext = require("./useInstantSearchContext");

function useSearchResults() {
  var search = (0, _useInstantSearchContext.useInstantSearchContext)();
  var searchIndex = (0, _useIndexContext.useIndexContext)();

  var _useState = (0, _react.useState)(function () {
    return (0, _getIndexSearchResults.getIndexSearchResults)(searchIndex);
  }),
      _useState2 = (0, _slicedToArray2.default)(_useState, 2),
      searchResults = _useState2[0],
      setSearchResults = _useState2[1];

  (0, _react.useEffect)(function () {
    function handleRender() {
      setSearchResults({
        results: searchIndex.getResults(),
        // Results can't be `null` after the first render.
        scopedResults: searchIndex.getScopedResults()
      });
    }

    search.addListener('render', handleRender);
    return function () {
      search.removeListener('render', handleRender);
    };
  }, [search, searchIndex]);
  return searchResults;
}