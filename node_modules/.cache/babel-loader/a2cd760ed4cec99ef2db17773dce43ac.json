{"ast":null,"code":"function ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport { checkIndexUiState, createDocumentationMessageGenerator, resolveSearchParameters, mergeSearchParameters, warning } from \"../../lib/utils/index.js\";\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'index-widget'\n});\nexport function isIndexWidget(widget) {\n  return widget.$$type === 'ais.index';\n}\n/**\n * This is the same content as helper._change / setState, but allowing for extra\n * UiState to be synchronized.\n * see: https://github.com/algolia/algoliasearch-helper-js/blob/6b835ffd07742f2d6b314022cce6848f5cfecd4a/src/algoliasearch.helper.js#L1311-L1324\n */\n\nfunction privateHelperSetState(helper, _ref) {\n  var state = _ref.state,\n      isPageReset = _ref.isPageReset,\n      _uiState = _ref._uiState;\n\n  if (state !== helper.state) {\n    helper.state = state;\n    helper.emit('change', {\n      state: helper.state,\n      results: helper.lastResults,\n      isPageReset: isPageReset,\n      _uiState: _uiState\n    });\n  }\n}\n\nfunction getLocalWidgetsUiState(widgets, widgetStateOptions) {\n  var initialUiState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return widgets.reduce(function (uiState, widget) {\n    if (isIndexWidget(widget)) {\n      return uiState;\n    }\n\n    if (!widget.getWidgetUiState && !widget.getWidgetState) {\n      return uiState;\n    }\n\n    if (widget.getWidgetUiState) {\n      return widget.getWidgetUiState(uiState, widgetStateOptions);\n    }\n\n    return widget.getWidgetState(uiState, widgetStateOptions);\n  }, initialUiState);\n}\n\nfunction getLocalWidgetsSearchParameters(widgets, widgetSearchParametersOptions) {\n  var initialSearchParameters = widgetSearchParametersOptions.initialSearchParameters,\n      rest = _objectWithoutProperties(widgetSearchParametersOptions, [\"initialSearchParameters\"]);\n\n  return widgets.filter(function (widget) {\n    return !isIndexWidget(widget);\n  }).reduce(function (state, widget) {\n    if (!widget.getWidgetSearchParameters) {\n      return state;\n    }\n\n    return widget.getWidgetSearchParameters(state, rest);\n  }, initialSearchParameters);\n}\n\nfunction resetPageFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n\n  if (indexWidgets.length === 0) {\n    return;\n  }\n\n  indexWidgets.forEach(function (widget) {\n    var widgetHelper = widget.getHelper();\n    privateHelperSetState(widgetHelper, {\n      state: widgetHelper.state.resetPage(),\n      isPageReset: true\n    });\n    resetPageFromWidgets(widget.getWidgets());\n  });\n}\n\nfunction resolveScopedResultsFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n  return indexWidgets.reduce(function (scopedResults, current) {\n    return scopedResults.concat.apply(scopedResults, [{\n      indexId: current.getIndexId(),\n      results: current.getResults(),\n      helper: current.getHelper()\n    }].concat(_toConsumableArray(resolveScopedResultsFromWidgets(current.getWidgets()))));\n  }, []);\n}\n\nvar index = function index(widgetParams) {\n  if (widgetParams === undefined || widgetParams.indexName === undefined) {\n    throw new Error(withUsage('The `indexName` option is required.'));\n  }\n\n  var indexName = widgetParams.indexName,\n      _widgetParams$indexId = widgetParams.indexId,\n      indexId = _widgetParams$indexId === void 0 ? indexName : _widgetParams$indexId;\n  var localWidgets = [];\n  var localUiState = {};\n  var localInstantSearchInstance = null;\n  var localParent = null;\n  var helper = null;\n  var derivedHelper = null;\n  return {\n    $$type: 'ais.index',\n    $$widgetType: 'ais.index',\n    getIndexName: function getIndexName() {\n      return indexName;\n    },\n    getIndexId: function getIndexId() {\n      return indexId;\n    },\n    getHelper: function getHelper() {\n      return helper;\n    },\n    getResults: function getResults() {\n      return derivedHelper && derivedHelper.lastResults;\n    },\n    getScopedResults: function getScopedResults() {\n      var widgetParent = this.getParent(); // If the widget is the root, we consider itself as the only sibling.\n\n      var widgetSiblings = widgetParent ? widgetParent.getWidgets() : [this];\n      return resolveScopedResultsFromWidgets(widgetSiblings);\n    },\n    getParent: function getParent() {\n      return localParent;\n    },\n    createURL: function createURL(nextState) {\n      return localInstantSearchInstance._createURL(_defineProperty({}, indexId, getLocalWidgetsUiState(localWidgets, {\n        searchParameters: nextState,\n        helper: helper\n      })));\n    },\n    getWidgets: function getWidgets() {\n      return localWidgets;\n    },\n    addWidgets: function addWidgets(widgets) {\n      var _this = this;\n\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `addWidgets` method expects an array of widgets.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.init !== 'function' && typeof widget.render !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `render` and/or an `init` method.'));\n      }\n\n      localWidgets = localWidgets.concat(widgets);\n\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        privateHelperSetState(helper, {\n          state: getLocalWidgetsSearchParameters(localWidgets, {\n            uiState: localUiState,\n            initialSearchParameters: helper.state\n          }),\n          _uiState: localUiState\n        }); // We compute the render state before calling `init` in a separate loop\n        // to construct the whole render state object that is then passed to\n        // `init`.\n\n        widgets.forEach(function (widget) {\n          if (widget.getRenderState) {\n            var renderState = widget.getRenderState(localInstantSearchInstance.renderState[_this.getIndexId()] || {}, {\n              uiState: localInstantSearchInstance._initialUiState,\n              helper: _this.getHelper(),\n              parent: _this,\n              instantSearchInstance: localInstantSearchInstance,\n              state: helper.state,\n              renderState: localInstantSearchInstance.renderState,\n              templatesConfig: localInstantSearchInstance.templatesConfig,\n              createURL: _this.createURL,\n              scopedResults: [],\n              searchMetadata: {\n                isSearchStalled: localInstantSearchInstance._isSearchStalled\n              }\n            });\n            storeRenderState({\n              renderState: renderState,\n              instantSearchInstance: localInstantSearchInstance,\n              parent: _this\n            });\n          }\n        });\n        widgets.forEach(function (widget) {\n          if (widget.init) {\n            widget.init({\n              helper: helper,\n              parent: _this,\n              uiState: localInstantSearchInstance._initialUiState,\n              instantSearchInstance: localInstantSearchInstance,\n              state: helper.state,\n              renderState: localInstantSearchInstance.renderState,\n              templatesConfig: localInstantSearchInstance.templatesConfig,\n              createURL: _this.createURL,\n              scopedResults: [],\n              searchMetadata: {\n                isSearchStalled: localInstantSearchInstance._isSearchStalled\n              }\n            });\n          }\n        });\n        localInstantSearchInstance.scheduleSearch();\n      }\n\n      return this;\n    },\n    removeWidgets: function removeWidgets(widgets) {\n      var _this2 = this;\n\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `removeWidgets` method expects an array of widgets.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.dispose !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `dispose` method.'));\n      }\n\n      localWidgets = localWidgets.filter(function (widget) {\n        return widgets.indexOf(widget) === -1;\n      });\n\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        var nextState = widgets.reduce(function (state, widget) {\n          // the `dispose` method exists at this point we already assert it\n          var next = widget.dispose({\n            helper: helper,\n            state: state,\n            parent: _this2\n          });\n          return next || state;\n        }, helper.state);\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: nextState,\n          helper: helper\n        });\n        helper.setState(getLocalWidgetsSearchParameters(localWidgets, {\n          uiState: localUiState,\n          initialSearchParameters: nextState\n        }));\n\n        if (localWidgets.length) {\n          localInstantSearchInstance.scheduleSearch();\n        }\n      }\n\n      return this;\n    },\n    init: function init(_ref2) {\n      var _this3 = this,\n          _instantSearchInstanc;\n\n      var instantSearchInstance = _ref2.instantSearchInstance,\n          parent = _ref2.parent,\n          uiState = _ref2.uiState;\n\n      if (helper !== null) {\n        // helper is already initialized, therefore we do not need to set up\n        // any listeners\n        return;\n      }\n\n      localInstantSearchInstance = instantSearchInstance;\n      localParent = parent;\n      localUiState = uiState[indexId] || {}; // The `mainHelper` is already defined at this point. The instance is created\n      // inside InstantSearch at the `start` method, which occurs before the `init`\n      // step.\n\n      var mainHelper = instantSearchInstance.mainHelper;\n      var parameters = getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: localUiState,\n        initialSearchParameters: new algoliasearchHelper.SearchParameters({\n          index: indexName\n        })\n      }); // This Helper is only used for state management we do not care about the\n      // `searchClient`. Only the \"main\" Helper created at the `InstantSearch`\n      // level is aware of the client.\n\n      helper = algoliasearchHelper({}, parameters.index, parameters); // We forward the call to `search` to the \"main\" instance of the Helper\n      // which is responsible for managing the queries (it's the only one that is\n      // aware of the `searchClient`).\n\n      helper.search = function () {\n        if (instantSearchInstance.onStateChange) {\n          instantSearchInstance.onStateChange({\n            uiState: instantSearchInstance.mainIndex.getWidgetUiState({}),\n            setUiState: instantSearchInstance.setUiState.bind(instantSearchInstance)\n          }); // We don't trigger a search when controlled because it becomes the\n          // responsibility of `setUiState`.\n\n          return mainHelper;\n        }\n\n        return mainHelper.search();\n      };\n\n      helper.searchWithoutTriggeringOnStateChange = function () {\n        return mainHelper.search();\n      }; // We use the same pattern for the `searchForFacetValues`.\n\n\n      helper.searchForFacetValues = function (facetName, facetValue, maxFacetHits, userState) {\n        var state = helper.state.setQueryParameters(userState);\n        return mainHelper.searchForFacetValues(facetName, facetValue, maxFacetHits, state);\n      };\n\n      derivedHelper = mainHelper.derive(function () {\n        return mergeSearchParameters.apply(void 0, _toConsumableArray(resolveSearchParameters(_this3)));\n      });\n      var indexInitialResults = (_instantSearchInstanc = instantSearchInstance._initialResults) === null || _instantSearchInstanc === void 0 ? void 0 : _instantSearchInstanc[this.getIndexId()];\n\n      if (indexInitialResults) {\n        // We restore the shape of the results provided to the instance to respect\n        // the helper's structure.\n        var results = new algoliasearchHelper.SearchResults(new algoliasearchHelper.SearchParameters(indexInitialResults.state), indexInitialResults.results);\n        derivedHelper.lastResults = results;\n        helper.lastResults = results;\n      } // Subscribe to the Helper state changes for the page before widgets\n      // are initialized. This behavior mimics the original one of the Helper.\n      // It makes sense to replicate it at the `init` step. We have another\n      // listener on `change` below, once `init` is done.\n\n\n      helper.on('change', function (_ref3) {\n        var isPageReset = _ref3.isPageReset;\n\n        if (isPageReset) {\n          resetPageFromWidgets(localWidgets);\n        }\n      });\n      derivedHelper.on('search', function () {\n        // The index does not manage the \"staleness\" of the search. This is the\n        // responsibility of the main instance. It does not make sense to manage\n        // it at the index level because it's either: all of them or none of them\n        // that are stalled. The queries are performed into a single network request.\n        instantSearchInstance.scheduleStalledRender();\n\n        if (process.env.NODE_ENV === 'development') {\n          checkIndexUiState({\n            index: _this3,\n            indexUiState: localUiState\n          });\n        }\n      });\n      derivedHelper.on('result', function (_ref4) {\n        var results = _ref4.results; // The index does not render the results it schedules a new render\n        // to let all the other indices emit their own results. It allows us to\n        // run the render process in one pass.\n\n        instantSearchInstance.scheduleRender(); // the derived helper is the one which actually searches, but the helper\n        // which is exposed e.g. via instance.helper, doesn't search, and thus\n        // does not have access to lastResults, which it used to in pre-federated\n        // search behavior.\n\n        helper.lastResults = results;\n      }); // We compute the render state before calling `init` in a separate loop\n      // to construct the whole render state object that is then passed to\n      // `init`.\n\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this3.getIndexId()] || {}, {\n            uiState: uiState,\n            helper: helper,\n            parent: _this3,\n            instantSearchInstance: instantSearchInstance,\n            state: helper.state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this3.createURL,\n            scopedResults: [],\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this3\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        process.env.NODE_ENV === 'development' ? warning( // if it has NO getWidgetState or if it has getWidgetUiState, we don't warn\n        // aka we warn if there's _only_ getWidgetState\n        !widget.getWidgetState || Boolean(widget.getWidgetUiState), 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n\n        if (widget.init) {\n          widget.init({\n            uiState: uiState,\n            helper: helper,\n            parent: _this3,\n            instantSearchInstance: instantSearchInstance,\n            state: helper.state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this3.createURL,\n            scopedResults: [],\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n        }\n      }); // Subscribe to the Helper state changes for the `uiState` once widgets\n      // are initialized. Until the first render, state changes are part of the\n      // configuration step. This is mainly for backward compatibility with custom\n      // widgets. When the subscription happens before the `init` step, the (static)\n      // configuration of the widget is pushed in the URL. That's what we want to avoid.\n      // https://github.com/algolia/instantsearch.js/pull/994/commits/4a672ae3fd78809e213de0368549ef12e9dc9454\n\n      helper.on('change', function (event) {\n        var state = event.state;\n        var _uiState = event._uiState;\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: state,\n          helper: helper\n        }, _uiState || {}); // We don't trigger an internal change when controlled because it\n        // becomes the responsibility of `setUiState`.\n\n        if (!instantSearchInstance.onStateChange) {\n          instantSearchInstance.onInternalStateChange();\n        }\n      });\n\n      if (indexInitialResults) {\n        // If there are initial results, we're not notified of the next results\n        // because we don't trigger an initial search. We therefore need to directly\n        // schedule a render that will render the results injected on the helper.\n        instantSearchInstance.scheduleRender();\n      }\n    },\n    render: function render(_ref5) {\n      var _this4 = this;\n\n      var instantSearchInstance = _ref5.instantSearchInstance;\n\n      if (!this.getResults()) {\n        return;\n      }\n\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this4.getIndexId()] || {}, {\n            helper: _this4.getHelper(),\n            parent: _this4,\n            instantSearchInstance: instantSearchInstance,\n            results: _this4.getResults(),\n            scopedResults: _this4.getScopedResults(),\n            state: _this4.getResults()._state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this4.createURL,\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this4\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        // At this point, all the variables used below are set. Both `helper`\n        // and `derivedHelper` have been created at the `init` step. The attribute\n        // `lastResults` might be `null` though. It's possible that a stalled render\n        // happens before the result e.g with a dynamically added index the request might\n        // be delayed. The render is triggered for the complete tree but some parts do\n        // not have results yet.\n        if (widget.render) {\n          widget.render({\n            helper: helper,\n            parent: _this4,\n            instantSearchInstance: instantSearchInstance,\n            results: _this4.getResults(),\n            scopedResults: _this4.getScopedResults(),\n            state: _this4.getResults()._state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this4.createURL,\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n        }\n      });\n    },\n    dispose: function dispose() {\n      var _this5 = this;\n\n      localWidgets.forEach(function (widget) {\n        if (widget.dispose) {\n          // The dispose function is always called once the instance is started\n          // (it's an effect of `removeWidgets`). The index is initialized and\n          // the Helper is available. We don't care about the return value of\n          // `dispose` because the index is removed. We can't call `removeWidgets`\n          // because we want to keep the widgets on the instance, to allow idempotent\n          // operations on `add` & `remove`.\n          widget.dispose({\n            helper: helper,\n            state: helper.state,\n            parent: _this5\n          });\n        }\n      });\n      localInstantSearchInstance = null;\n      localParent = null;\n      helper.removeAllListeners();\n      helper = null;\n      derivedHelper.detach();\n      derivedHelper = null;\n    },\n    getWidgetUiState: function getWidgetUiState(uiState) {\n      return localWidgets.filter(isIndexWidget).reduce(function (previousUiState, innerIndex) {\n        return innerIndex.getWidgetUiState(previousUiState);\n      }, _objectSpread(_objectSpread({}, uiState), {}, _defineProperty({}, this.getIndexId(), localUiState)));\n    },\n    getWidgetState: function getWidgetState(uiState) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n      return this.getWidgetUiState(uiState);\n    },\n    getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref6) {\n      var uiState = _ref6.uiState;\n      return getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: uiState,\n        initialSearchParameters: searchParameters\n      });\n    },\n    refreshUiState: function refreshUiState() {\n      localUiState = getLocalWidgetsUiState(localWidgets, {\n        searchParameters: this.getHelper().state,\n        helper: this.getHelper()\n      }, localUiState);\n    }\n  };\n};\n\nexport default index;\n\nfunction storeRenderState(_ref7) {\n  var renderState = _ref7.renderState,\n      instantSearchInstance = _ref7.instantSearchInstance,\n      parent = _ref7.parent;\n  var parentIndexName = parent ? parent.getIndexId() : instantSearchInstance.mainIndex.getIndexId();\n  instantSearchInstance.renderState = _objectSpread(_objectSpread({}, instantSearchInstance.renderState), {}, _defineProperty({}, parentIndexName, _objectSpread(_objectSpread({}, instantSearchInstance.renderState[parentIndexName]), renderState)));\n}","map":{"version":3,"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","arr2","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","propertyIsEnumerable","sourceKeys","algoliasearchHelper","checkIndexUiState","createDocumentationMessageGenerator","resolveSearchParameters","mergeSearchParameters","warning","withUsage","isIndexWidget","widget","$$type","privateHelperSetState","helper","_ref","state","isPageReset","_uiState","emit","results","lastResults","getLocalWidgetsUiState","widgets","widgetStateOptions","initialUiState","undefined","reduce","uiState","getWidgetUiState","getWidgetState","getLocalWidgetsSearchParameters","widgetSearchParametersOptions","initialSearchParameters","rest","getWidgetSearchParameters","resetPageFromWidgets","indexWidgets","widgetHelper","getHelper","resetPage","getWidgets","resolveScopedResultsFromWidgets","scopedResults","current","concat","indexId","getIndexId","getResults","index","widgetParams","indexName","Error","_widgetParams$indexId","localWidgets","localUiState","localInstantSearchInstance","localParent","derivedHelper","$$widgetType","getIndexName","getScopedResults","widgetParent","getParent","widgetSiblings","createURL","nextState","_createURL","searchParameters","addWidgets","_this","some","init","render","Boolean","getRenderState","renderState","_initialUiState","parent","instantSearchInstance","templatesConfig","searchMetadata","isSearchStalled","_isSearchStalled","storeRenderState","scheduleSearch","removeWidgets","_this2","dispose","next","setState","_ref2","_this3","_instantSearchInstanc","mainHelper","parameters","SearchParameters","search","onStateChange","mainIndex","setUiState","bind","searchWithoutTriggeringOnStateChange","searchForFacetValues","facetName","facetValue","maxFacetHits","userState","setQueryParameters","derive","indexInitialResults","_initialResults","SearchResults","on","_ref3","scheduleStalledRender","process","env","NODE_ENV","indexUiState","_ref4","scheduleRender","event","onInternalStateChange","_ref5","_this4","_state","_this5","removeAllListeners","detach","previousUiState","innerIndex","_ref6","refreshUiState","_ref7","parentIndexName"],"sources":["/Users/christoalex/Algolia/my-app/node_modules/instantsearch.js/es/widgets/index/index.js"],"sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport { checkIndexUiState, createDocumentationMessageGenerator, resolveSearchParameters, mergeSearchParameters, warning } from \"../../lib/utils/index.js\";\nvar withUsage = createDocumentationMessageGenerator({\n  name: 'index-widget'\n});\nexport function isIndexWidget(widget) {\n  return widget.$$type === 'ais.index';\n}\n/**\n * This is the same content as helper._change / setState, but allowing for extra\n * UiState to be synchronized.\n * see: https://github.com/algolia/algoliasearch-helper-js/blob/6b835ffd07742f2d6b314022cce6848f5cfecd4a/src/algoliasearch.helper.js#L1311-L1324\n */\n\nfunction privateHelperSetState(helper, _ref) {\n  var state = _ref.state,\n      isPageReset = _ref.isPageReset,\n      _uiState = _ref._uiState;\n\n  if (state !== helper.state) {\n    helper.state = state;\n    helper.emit('change', {\n      state: helper.state,\n      results: helper.lastResults,\n      isPageReset: isPageReset,\n      _uiState: _uiState\n    });\n  }\n}\n\nfunction getLocalWidgetsUiState(widgets, widgetStateOptions) {\n  var initialUiState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return widgets.reduce(function (uiState, widget) {\n    if (isIndexWidget(widget)) {\n      return uiState;\n    }\n\n    if (!widget.getWidgetUiState && !widget.getWidgetState) {\n      return uiState;\n    }\n\n    if (widget.getWidgetUiState) {\n      return widget.getWidgetUiState(uiState, widgetStateOptions);\n    }\n\n    return widget.getWidgetState(uiState, widgetStateOptions);\n  }, initialUiState);\n}\n\nfunction getLocalWidgetsSearchParameters(widgets, widgetSearchParametersOptions) {\n  var initialSearchParameters = widgetSearchParametersOptions.initialSearchParameters,\n      rest = _objectWithoutProperties(widgetSearchParametersOptions, [\"initialSearchParameters\"]);\n\n  return widgets.filter(function (widget) {\n    return !isIndexWidget(widget);\n  }).reduce(function (state, widget) {\n    if (!widget.getWidgetSearchParameters) {\n      return state;\n    }\n\n    return widget.getWidgetSearchParameters(state, rest);\n  }, initialSearchParameters);\n}\n\nfunction resetPageFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n\n  if (indexWidgets.length === 0) {\n    return;\n  }\n\n  indexWidgets.forEach(function (widget) {\n    var widgetHelper = widget.getHelper();\n    privateHelperSetState(widgetHelper, {\n      state: widgetHelper.state.resetPage(),\n      isPageReset: true\n    });\n    resetPageFromWidgets(widget.getWidgets());\n  });\n}\n\nfunction resolveScopedResultsFromWidgets(widgets) {\n  var indexWidgets = widgets.filter(isIndexWidget);\n  return indexWidgets.reduce(function (scopedResults, current) {\n    return scopedResults.concat.apply(scopedResults, [{\n      indexId: current.getIndexId(),\n      results: current.getResults(),\n      helper: current.getHelper()\n    }].concat(_toConsumableArray(resolveScopedResultsFromWidgets(current.getWidgets()))));\n  }, []);\n}\n\nvar index = function index(widgetParams) {\n  if (widgetParams === undefined || widgetParams.indexName === undefined) {\n    throw new Error(withUsage('The `indexName` option is required.'));\n  }\n\n  var indexName = widgetParams.indexName,\n      _widgetParams$indexId = widgetParams.indexId,\n      indexId = _widgetParams$indexId === void 0 ? indexName : _widgetParams$indexId;\n  var localWidgets = [];\n  var localUiState = {};\n  var localInstantSearchInstance = null;\n  var localParent = null;\n  var helper = null;\n  var derivedHelper = null;\n  return {\n    $$type: 'ais.index',\n    $$widgetType: 'ais.index',\n    getIndexName: function getIndexName() {\n      return indexName;\n    },\n    getIndexId: function getIndexId() {\n      return indexId;\n    },\n    getHelper: function getHelper() {\n      return helper;\n    },\n    getResults: function getResults() {\n      return derivedHelper && derivedHelper.lastResults;\n    },\n    getScopedResults: function getScopedResults() {\n      var widgetParent = this.getParent(); // If the widget is the root, we consider itself as the only sibling.\n\n      var widgetSiblings = widgetParent ? widgetParent.getWidgets() : [this];\n      return resolveScopedResultsFromWidgets(widgetSiblings);\n    },\n    getParent: function getParent() {\n      return localParent;\n    },\n    createURL: function createURL(nextState) {\n      return localInstantSearchInstance._createURL(_defineProperty({}, indexId, getLocalWidgetsUiState(localWidgets, {\n        searchParameters: nextState,\n        helper: helper\n      })));\n    },\n    getWidgets: function getWidgets() {\n      return localWidgets;\n    },\n    addWidgets: function addWidgets(widgets) {\n      var _this = this;\n\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `addWidgets` method expects an array of widgets.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.init !== 'function' && typeof widget.render !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `render` and/or an `init` method.'));\n      }\n\n      localWidgets = localWidgets.concat(widgets);\n\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        privateHelperSetState(helper, {\n          state: getLocalWidgetsSearchParameters(localWidgets, {\n            uiState: localUiState,\n            initialSearchParameters: helper.state\n          }),\n          _uiState: localUiState\n        }); // We compute the render state before calling `init` in a separate loop\n        // to construct the whole render state object that is then passed to\n        // `init`.\n\n        widgets.forEach(function (widget) {\n          if (widget.getRenderState) {\n            var renderState = widget.getRenderState(localInstantSearchInstance.renderState[_this.getIndexId()] || {}, {\n              uiState: localInstantSearchInstance._initialUiState,\n              helper: _this.getHelper(),\n              parent: _this,\n              instantSearchInstance: localInstantSearchInstance,\n              state: helper.state,\n              renderState: localInstantSearchInstance.renderState,\n              templatesConfig: localInstantSearchInstance.templatesConfig,\n              createURL: _this.createURL,\n              scopedResults: [],\n              searchMetadata: {\n                isSearchStalled: localInstantSearchInstance._isSearchStalled\n              }\n            });\n            storeRenderState({\n              renderState: renderState,\n              instantSearchInstance: localInstantSearchInstance,\n              parent: _this\n            });\n          }\n        });\n        widgets.forEach(function (widget) {\n          if (widget.init) {\n            widget.init({\n              helper: helper,\n              parent: _this,\n              uiState: localInstantSearchInstance._initialUiState,\n              instantSearchInstance: localInstantSearchInstance,\n              state: helper.state,\n              renderState: localInstantSearchInstance.renderState,\n              templatesConfig: localInstantSearchInstance.templatesConfig,\n              createURL: _this.createURL,\n              scopedResults: [],\n              searchMetadata: {\n                isSearchStalled: localInstantSearchInstance._isSearchStalled\n              }\n            });\n          }\n        });\n        localInstantSearchInstance.scheduleSearch();\n      }\n\n      return this;\n    },\n    removeWidgets: function removeWidgets(widgets) {\n      var _this2 = this;\n\n      if (!Array.isArray(widgets)) {\n        throw new Error(withUsage('The `removeWidgets` method expects an array of widgets.'));\n      }\n\n      if (widgets.some(function (widget) {\n        return typeof widget.dispose !== 'function';\n      })) {\n        throw new Error(withUsage('The widget definition expects a `dispose` method.'));\n      }\n\n      localWidgets = localWidgets.filter(function (widget) {\n        return widgets.indexOf(widget) === -1;\n      });\n\n      if (localInstantSearchInstance && Boolean(widgets.length)) {\n        var nextState = widgets.reduce(function (state, widget) {\n          // the `dispose` method exists at this point we already assert it\n          var next = widget.dispose({\n            helper: helper,\n            state: state,\n            parent: _this2\n          });\n          return next || state;\n        }, helper.state);\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: nextState,\n          helper: helper\n        });\n        helper.setState(getLocalWidgetsSearchParameters(localWidgets, {\n          uiState: localUiState,\n          initialSearchParameters: nextState\n        }));\n\n        if (localWidgets.length) {\n          localInstantSearchInstance.scheduleSearch();\n        }\n      }\n\n      return this;\n    },\n    init: function init(_ref2) {\n      var _this3 = this,\n          _instantSearchInstanc;\n\n      var instantSearchInstance = _ref2.instantSearchInstance,\n          parent = _ref2.parent,\n          uiState = _ref2.uiState;\n\n      if (helper !== null) {\n        // helper is already initialized, therefore we do not need to set up\n        // any listeners\n        return;\n      }\n\n      localInstantSearchInstance = instantSearchInstance;\n      localParent = parent;\n      localUiState = uiState[indexId] || {}; // The `mainHelper` is already defined at this point. The instance is created\n      // inside InstantSearch at the `start` method, which occurs before the `init`\n      // step.\n\n      var mainHelper = instantSearchInstance.mainHelper;\n      var parameters = getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: localUiState,\n        initialSearchParameters: new algoliasearchHelper.SearchParameters({\n          index: indexName\n        })\n      }); // This Helper is only used for state management we do not care about the\n      // `searchClient`. Only the \"main\" Helper created at the `InstantSearch`\n      // level is aware of the client.\n\n      helper = algoliasearchHelper({}, parameters.index, parameters); // We forward the call to `search` to the \"main\" instance of the Helper\n      // which is responsible for managing the queries (it's the only one that is\n      // aware of the `searchClient`).\n\n      helper.search = function () {\n        if (instantSearchInstance.onStateChange) {\n          instantSearchInstance.onStateChange({\n            uiState: instantSearchInstance.mainIndex.getWidgetUiState({}),\n            setUiState: instantSearchInstance.setUiState.bind(instantSearchInstance)\n          }); // We don't trigger a search when controlled because it becomes the\n          // responsibility of `setUiState`.\n\n          return mainHelper;\n        }\n\n        return mainHelper.search();\n      };\n\n      helper.searchWithoutTriggeringOnStateChange = function () {\n        return mainHelper.search();\n      }; // We use the same pattern for the `searchForFacetValues`.\n\n\n      helper.searchForFacetValues = function (facetName, facetValue, maxFacetHits, userState) {\n        var state = helper.state.setQueryParameters(userState);\n        return mainHelper.searchForFacetValues(facetName, facetValue, maxFacetHits, state);\n      };\n\n      derivedHelper = mainHelper.derive(function () {\n        return mergeSearchParameters.apply(void 0, _toConsumableArray(resolveSearchParameters(_this3)));\n      });\n      var indexInitialResults = (_instantSearchInstanc = instantSearchInstance._initialResults) === null || _instantSearchInstanc === void 0 ? void 0 : _instantSearchInstanc[this.getIndexId()];\n\n      if (indexInitialResults) {\n        // We restore the shape of the results provided to the instance to respect\n        // the helper's structure.\n        var results = new algoliasearchHelper.SearchResults(new algoliasearchHelper.SearchParameters(indexInitialResults.state), indexInitialResults.results);\n        derivedHelper.lastResults = results;\n        helper.lastResults = results;\n      } // Subscribe to the Helper state changes for the page before widgets\n      // are initialized. This behavior mimics the original one of the Helper.\n      // It makes sense to replicate it at the `init` step. We have another\n      // listener on `change` below, once `init` is done.\n\n\n      helper.on('change', function (_ref3) {\n        var isPageReset = _ref3.isPageReset;\n\n        if (isPageReset) {\n          resetPageFromWidgets(localWidgets);\n        }\n      });\n      derivedHelper.on('search', function () {\n        // The index does not manage the \"staleness\" of the search. This is the\n        // responsibility of the main instance. It does not make sense to manage\n        // it at the index level because it's either: all of them or none of them\n        // that are stalled. The queries are performed into a single network request.\n        instantSearchInstance.scheduleStalledRender();\n\n        if (process.env.NODE_ENV === 'development') {\n          checkIndexUiState({\n            index: _this3,\n            indexUiState: localUiState\n          });\n        }\n      });\n      derivedHelper.on('result', function (_ref4) {\n        var results = _ref4.results;\n        // The index does not render the results it schedules a new render\n        // to let all the other indices emit their own results. It allows us to\n        // run the render process in one pass.\n        instantSearchInstance.scheduleRender(); // the derived helper is the one which actually searches, but the helper\n        // which is exposed e.g. via instance.helper, doesn't search, and thus\n        // does not have access to lastResults, which it used to in pre-federated\n        // search behavior.\n\n        helper.lastResults = results;\n      }); // We compute the render state before calling `init` in a separate loop\n      // to construct the whole render state object that is then passed to\n      // `init`.\n\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this3.getIndexId()] || {}, {\n            uiState: uiState,\n            helper: helper,\n            parent: _this3,\n            instantSearchInstance: instantSearchInstance,\n            state: helper.state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this3.createURL,\n            scopedResults: [],\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this3\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        process.env.NODE_ENV === 'development' ? warning( // if it has NO getWidgetState or if it has getWidgetUiState, we don't warn\n        // aka we warn if there's _only_ getWidgetState\n        !widget.getWidgetState || Boolean(widget.getWidgetUiState), 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n\n        if (widget.init) {\n          widget.init({\n            uiState: uiState,\n            helper: helper,\n            parent: _this3,\n            instantSearchInstance: instantSearchInstance,\n            state: helper.state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this3.createURL,\n            scopedResults: [],\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n        }\n      }); // Subscribe to the Helper state changes for the `uiState` once widgets\n      // are initialized. Until the first render, state changes are part of the\n      // configuration step. This is mainly for backward compatibility with custom\n      // widgets. When the subscription happens before the `init` step, the (static)\n      // configuration of the widget is pushed in the URL. That's what we want to avoid.\n      // https://github.com/algolia/instantsearch.js/pull/994/commits/4a672ae3fd78809e213de0368549ef12e9dc9454\n\n      helper.on('change', function (event) {\n        var state = event.state;\n        var _uiState = event._uiState;\n        localUiState = getLocalWidgetsUiState(localWidgets, {\n          searchParameters: state,\n          helper: helper\n        }, _uiState || {}); // We don't trigger an internal change when controlled because it\n        // becomes the responsibility of `setUiState`.\n\n        if (!instantSearchInstance.onStateChange) {\n          instantSearchInstance.onInternalStateChange();\n        }\n      });\n\n      if (indexInitialResults) {\n        // If there are initial results, we're not notified of the next results\n        // because we don't trigger an initial search. We therefore need to directly\n        // schedule a render that will render the results injected on the helper.\n        instantSearchInstance.scheduleRender();\n      }\n    },\n    render: function render(_ref5) {\n      var _this4 = this;\n\n      var instantSearchInstance = _ref5.instantSearchInstance;\n\n      if (!this.getResults()) {\n        return;\n      }\n\n      localWidgets.forEach(function (widget) {\n        if (widget.getRenderState) {\n          var renderState = widget.getRenderState(instantSearchInstance.renderState[_this4.getIndexId()] || {}, {\n            helper: _this4.getHelper(),\n            parent: _this4,\n            instantSearchInstance: instantSearchInstance,\n            results: _this4.getResults(),\n            scopedResults: _this4.getScopedResults(),\n            state: _this4.getResults()._state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this4.createURL,\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n          storeRenderState({\n            renderState: renderState,\n            instantSearchInstance: instantSearchInstance,\n            parent: _this4\n          });\n        }\n      });\n      localWidgets.forEach(function (widget) {\n        // At this point, all the variables used below are set. Both `helper`\n        // and `derivedHelper` have been created at the `init` step. The attribute\n        // `lastResults` might be `null` though. It's possible that a stalled render\n        // happens before the result e.g with a dynamically added index the request might\n        // be delayed. The render is triggered for the complete tree but some parts do\n        // not have results yet.\n        if (widget.render) {\n          widget.render({\n            helper: helper,\n            parent: _this4,\n            instantSearchInstance: instantSearchInstance,\n            results: _this4.getResults(),\n            scopedResults: _this4.getScopedResults(),\n            state: _this4.getResults()._state,\n            renderState: instantSearchInstance.renderState,\n            templatesConfig: instantSearchInstance.templatesConfig,\n            createURL: _this4.createURL,\n            searchMetadata: {\n              isSearchStalled: instantSearchInstance._isSearchStalled\n            }\n          });\n        }\n      });\n    },\n    dispose: function dispose() {\n      var _this5 = this;\n\n      localWidgets.forEach(function (widget) {\n        if (widget.dispose) {\n          // The dispose function is always called once the instance is started\n          // (it's an effect of `removeWidgets`). The index is initialized and\n          // the Helper is available. We don't care about the return value of\n          // `dispose` because the index is removed. We can't call `removeWidgets`\n          // because we want to keep the widgets on the instance, to allow idempotent\n          // operations on `add` & `remove`.\n          widget.dispose({\n            helper: helper,\n            state: helper.state,\n            parent: _this5\n          });\n        }\n      });\n      localInstantSearchInstance = null;\n      localParent = null;\n      helper.removeAllListeners();\n      helper = null;\n      derivedHelper.detach();\n      derivedHelper = null;\n    },\n    getWidgetUiState: function getWidgetUiState(uiState) {\n      return localWidgets.filter(isIndexWidget).reduce(function (previousUiState, innerIndex) {\n        return innerIndex.getWidgetUiState(previousUiState);\n      }, _objectSpread(_objectSpread({}, uiState), {}, _defineProperty({}, this.getIndexId(), localUiState)));\n    },\n    getWidgetState: function getWidgetState(uiState) {\n      process.env.NODE_ENV === 'development' ? warning(false, 'The `getWidgetState` method is renamed `getWidgetUiState` and will no longer exist under that name in InstantSearch.js 5.x. Please use `getWidgetUiState` instead.') : void 0;\n      return this.getWidgetUiState(uiState);\n    },\n    getWidgetSearchParameters: function getWidgetSearchParameters(searchParameters, _ref6) {\n      var uiState = _ref6.uiState;\n      return getLocalWidgetsSearchParameters(localWidgets, {\n        uiState: uiState,\n        initialSearchParameters: searchParameters\n      });\n    },\n    refreshUiState: function refreshUiState() {\n      localUiState = getLocalWidgetsUiState(localWidgets, {\n        searchParameters: this.getHelper().state,\n        helper: this.getHelper()\n      }, localUiState);\n    }\n  };\n};\n\nexport default index;\n\nfunction storeRenderState(_ref7) {\n  var renderState = _ref7.renderState,\n      instantSearchInstance = _ref7.instantSearchInstance,\n      parent = _ref7.parent;\n  var parentIndexName = parent ? parent.getIndexId() : instantSearchInstance.mainIndex.getIndexId();\n  instantSearchInstance.renderState = _objectSpread(_objectSpread({}, instantSearchInstance.renderState), {}, _defineProperty({}, parentIndexName, _objectSpread(_objectSpread({}, instantSearchInstance.renderState[parentIndexName]), renderState)));\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}